# Как добавить свой источник данных в Grafana

### Проверяем или добавляем новый кластер
В папке values/ лежат файлики с названиями кластеров, в которых описаны пути до источников данных в формате yaml.
>:warning: Источники данных называются по названию файла в указанном пути без расширения .yaml

Имена кластеров можно подсмотреть в папке на уровень выше - clusters-permissions/values

### Описание манифеста
Рассмотрим пример на кластере customer-stage:

```
datasources:
  - name: influxdb
    path: customer/stage/influxdb
```

Первый ключ datasources остается неизменным и пишется всегда.

Внутри ключа следует список, необходимо указать:
- имя (name) - к примеру это может быть название проекта или тип источника данных
- путь (path) - путь до папки с манифестами в формате yaml, которые описывают поле `spec` ресурса `GrafanaAdditionalDatasource` (путь только до папки с файлами, до файлов не надо писать. Так же не надо указывать в начале пути datasources)

С содержимым поля `spec` ресурса `GrafanaAdditionalDatasource` можно ознакомиться в документации Deckhouse.
Пример ссылки: `https://documentation-<your cluster>.apps.lmru.tech/en/modules/300-prometheus/cr.html#grafanaadditionaldatasource`

### Подключение нового источника данных

Не рекомендуется использовать подключение новых источников данных расположенных в одном кластере Deckhouse через Ingress, так как это может привести к неоптимальному роутингу трафика и увеличению времени отклика.
Прямое кластерное взаимодействие между сервисами позволяет снизить задержку.

Рекомендуется использовать следующий формат:

`http://<service-name>.<namespace>:<port>`

