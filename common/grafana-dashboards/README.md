# Как добавить свой дашборд в кластер

### Проверяем или добавляем новый кластер
В папке `values/` лежат файлики с названиями кластеров, в которых описаны пути до дашбордов в формате json и в какую папку в grafana должен быть добавлен (добавлены) дашборд. Также нужно проверить, что кластер добавлен в [`devops-core.yaml`](https://github.lmru.tech/adeo/lmru--devops--argocd/tree/master/argocd-crd/values) (в секцию `grafana-dashboards.list.clusterlist`).

Имена кластеров можно подсмотреть в папке на уровень выше - clusters-permissions/values

> [!TIP]
> Если один дашборд необходим в нескольких кластерах, достаточно сложить дашборд в одно место и ссылаться на него.
> Если дашборд нужен во всех кластерах или почти во всех - директория [dashboards/common](dashboards/common) как раз для этого.  
> Не забудьте сослаться на директорию в `values` своих кластеров. 

### Описание манифеста
Рассмотрим пример на кластере kong-x1-stage:

```
dashboards:
  - name: victoriametrics
    path: kong-x1-stage/victoriametrics
    folder: custom
  - name: test-vm
    path: kong-x1-stage/victoriametrics
    folder: custom
  - name: common
    path: 'common/**'
    folder: common
```

Первый ключ dashboards остается неизменным и пишется всегда.

Внутри ключа следует список, необходимо указать:
- имя (name) - к примеру это может быть название проекта или самого графика
- путь (path) - путь до папки с дашбордами в формате json (путь только до папки с файлами, до файлов не надо писать. Так же не надо указывать в начале пути dashboards), поддерживается синтаксис [Glob](https://pkg.go.dev/github.com/gobwas/glob#pkg-types), как в последнем примере. 
- папка (folder) - имя папки, в которую попадет дашборд в Grafana

В один кластер можно задеплоить множество дашбордов в разные папки. Может пригодится при разбивке дашбордов по проектам или сущностям.
